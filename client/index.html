<!DOCTYPE html>
<html ng-app='drone'>
  <head>
    <meta charset="utf-8" />
    <title>Drones for Good</title>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700,600,600italic,800italic,800,700italic' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="lib/normalize.css/normalize.css" />
    <link rel="stylesheet" type="text/css" href="styles/style.css" />
  </head>
  <body>
    <nav class="navigation">
      <h1>Drones for Good</h1>      
      <div class="nav-items">
        <a class="selected" href="#/home">Map</a>
        <a href="#/pilotProfile">Pilots</a>
        <a href="#/seekerProfile">Seekers</a>
        <a href="#/projects">Projects</a> 
        <a href="#/logout">Logout</a>   
      </div>
    </nav>
    <div class="main-body">
      

      <!-- the ng-view directive is where our templates will be loaded into when naviagted to -->
      <div ng-view></div>

      <div id="map"></div>

    </div>
    <script src="https://maps.googleapis.com/maps/api/js"></script>
    <script>
      //Marker coordinates
      var testMarkers = [
        { lat: 37.909884, lng: -122.574783}, 
        { lat: 37.842677, lng: -122.116104},
        { lat: 37.961874, lng: -122.223221},
        { lat: 37.540574, lng: -122.437454}
      ];

      //Set image url for marker, and change orgin/anchor so 
      //flagpole bottom centered on marker coordinates
      var image = {
        url: 'tiny_green_flag',
        //size: new google.maps.Size(20, 32),
        origin: new google.maps.Point(0, 0),
        anchor: new google.maps.Point(0, 32)
      };

      //Make content array for info window
      var contentArray = [
        '<p>A botanical survey of Golden Gate Park</p>',
        '<p>Kristins magical cachement</p>',
        '<p>Some other random survey</p>',
        '<p>Tads SF Bay tide coverage</p>'
      ];

      //A function for creating a new info window.  
      var makeInfoWindow = function (contentString) {
        var infowindow = new google.maps.InfoWindow({
          content: contentString,
          maxWidth: 200
        });
        return infowindow;
      }

      //Function for adding markers to map object
      function addMarker(location, map, infowindow) {
        var marker = new google.maps.Marker({
          position: location,
          map: map,
          animation: google.maps.Animation.DROP,
          icon: image
        });
        marker.addListener('click', function () {
          infowindow.open(map, marker);
        })
      };

      //Function which creates map object and appends map to the dom.
      function initialize() {
        //Grab map element in DOM and specify options
        var mapCanvas = document.getElementById('map');
        var mapOptions = {
          center: new google.maps.LatLng(37.789, -122.416),
          zoom: 9,
          mapTypeId: google.maps.MapTypeId.HYBRID
        }
        //Make new instance of google maps object
        var map = new google.maps.Map(mapCanvas, mapOptions)

        //Attach all no fly zone geoJSON data 
        map.data.loadGeoJson('https://raw.githubusercontent.com/mapbox/drone-feedback/master/sources/geojson/5_mile_airport.geojson');
        map.data.loadGeoJson('https://raw.githubusercontent.com/mapbox/drone-feedback/master/sources/geojson/us_military.geojson');
        map.data.loadGeoJson('https://raw.githubusercontent.com/mapbox/drone-feedback/master/sources/geojson/us_national_park.geojson');

        //Set main styles for no fly zone data
        map.data.setStyle({
          fillOpacity: .5,
          strokeWeight: 2,
          fillColor: 'red'
        });

        //Iterate over testMarkers and add a marker for each one.
        //Pass addMarker a latLng, map instance, and infowindow instance
        for (var i = 0; i < testMarkers.length; i++) {
          var location = testMarkers[i];
          addMarker(location, map, makeInfoWindow(contentArray[i]) );
        }

      }

      //When page loads, create the map
      google.maps.event.addDomListener(window, 'load', initialize);
    </script>


    <script src="lib/angular/angular.js"></script>
    <script src="lib/angular-route/angular-route.js"></script>

    <script src="app/auth/auth.js"></script>
    <script src="app/projects/projects.js"></script>
    <script src="app/map/map.js"></script>
    <script src="app/users/seekers.js"></script>
    <script src="app/users/pilots.js"></script>
    <script src="app/services/services.js"></script>
    <script src="app/app.js"></script>
  </body>
</html>
